# Развертывание системы авторизации на сервере

## Быстрая синхронизация

```bash
# Синхронизировать все файлы, включая users.db
./sync_to_vz2.sh
```

## Что синхронизируется

- ✅ `auth_db.py` - модуль работы с базой данных
- ✅ `create_user.py` - скрипт управления пользователями
- ✅ `users.db` - база данных пользователей (SQLite)
- ✅ Обновленные Streamlit приложения с авторизацией
- ✅ `requirements.txt` - с добавленным bcrypt

## После синхронизации на сервере

### 1. Установить зависимости

```bash
ssh -p 1194 root@82.114.2.2
cd /usr/local/projects/ai_report
pip install bcrypt>=4.0.0
# или
pip install -r requirements.txt
```

### 2. Проверить базу данных пользователей

```bash
# Проверить, что users.db синхронизирована
ls -lh users.db

# Проверить пользователей
python3 create_user.py list
```

### 3. При необходимости создать пользователей на сервере

Если база данных не синхронизировалась или нужно создать пользователей заново:

```bash
# Создать суперпользователя
python3 create_user.py create --username admin --password your_password --superuser

# Создать обычных пользователей
python3 create_user.py create --username user1 --password pass123
```

### 4. Запустить Streamlit

```bash
streamlit run streamlit_report_oracle_backup.py --server.port 8501
```

## Проверка работы

1. Откройте браузер: `http://82.114.2.2:8501`
2. Должна отобразиться страница авторизации
3. Войдите с созданными учетными данными
4. После входа должен открыться интерфейс отчетов

## Важные замечания

- ⚠️ `users.db` содержит хеши паролей - храните в безопасности
- ⚠️ Не коммитьте `users.db` в git (добавлена в .gitignore)
- ✅ База данных синхронизируется через rsync на сервер
- ✅ При необходимости можно создать пользователей напрямую на сервере через скрипт

