{
  "table_name": "BM_TARIFFEL",
  "schema": "billing",
  "description": "Тарифные элементы - детальная тарификация тарифов. Содержит цены (MONEY) и параметры тарификации (STEP1-STEP4 для ступеней, LOGIN_QTY для количества логинов и т.д.). Один тариф (BM_TARIFF) может иметь несколько тарифных элементов с разными типами тарификации.",
  "database": "Oracle (production)",
  "key_columns": {
    "TARIFFEL_ID": "Уникальный идентификатор тарифного элемента (PRIMARY KEY)",
    "TARIFF_ID": "ID тарифа из BM_TARIFF. Связь с BM_TARIFF.TARIFF_ID",
    "TARIFFEL_TYPE_ID": "Тип тарифного элемента из BM_TARIFFEL_TYPE (например, абонентская плата, превышение трафика и т.д.)",
    "MONEY": "Цена/стоимость (NUMBER(38,15)). Основное поле для расчета доходов",
    "DATE_BEG": "Дата начала действия тарифного элемента",
    "DATE_END": "Дата окончания действия тарифного элемента (NULL если действует сейчас)",
    "STEP1": "Первая ступень тарификации (например, объем трафика)",
    "STEP2": "Вторая ступень тарификации",
    "STEP3": "Третья ступень тарификации",
    "STEP4": "Четвертая ступень тарификации",
    "LOGIN_QTY": "Количество логинов",
    "FLAG_VALUE": "Флаг/значение",
    "PERIODIC_TYPE_ID": "Тип периодичности (ежемесячно, ежедневно и т.д.)",
    "RESOURCE_TYPE_ID": "Тип ресурса из BM_RESOURCE_TYPE. Связь с BM_RESOURCE_TYPE.RESOURCE_TYPE_ID. Используется для расшифровки услуг для бухгалтерии (MNEMONIC имеет хороший мнемонический смысл)",
    "ROOT_ID": "Корневой элемент (для иерархии)",
    "HEIR_ID": "Наследник (для иерархии)",
    "ZONE_ID": "ID зоны из BM_ZONE. Связь с BM_ZONE.ZONE_ID. Используется для тарификации с фиксированной ценой зоны в тарифном плане",
    "SEGMENT_ID": "ID сегмента",
    "CNT_PERIOD_ID": "ID периода счетчика",
    "COUNTER_CLASS_ID": "ID класса счетчика",
    "DESCRIPTION": "Описание тарифного элемента"
  },
  "business_rules": [
    "MONEY - основное поле для расчета доходов (цена услуги, стоимость превышения и т.д.)",
    "Один тариф может иметь несколько тарифных элементов (например, абонентская плата + превышение трафика)",
    "TARIFFEL_TYPE_ID определяет тип тарификации (абонентская плата, превышение, дополнительные услуги)",
    "STEP1-STEP4 используются для ступенчатой тарификации (аналогично TIER1-TIER3 в TARIFF_PLANS Иридиум)",
    "Для расчета доходов нужно суммировать MONEY всех тарифных элементов тарифа",
    "DATE_BEG и DATE_END определяют период действия тарифного элемента",
    "Для получения актуальных цен: DATE_END IS NULL или DATE_END >= текущая дата"
  ],
  "relationships": [
    {
      "table": "BM_TARIFF",
      "type": "JOIN",
      "on": "BM_TARIFFEL.TARIFF_ID = BM_TARIFF.TARIFF_ID"
    },
    {
      "table": "BM_TARIFFEL_TYPE",
      "type": "LEFT JOIN",
      "on": "BM_TARIFFEL.TARIFFEL_TYPE_ID = BM_TARIFFEL_TYPE.TARIFFEL_TYPE_ID"
    },
    {
      "table": "BM_RESOURCE_TYPE",
      "type": "LEFT JOIN",
      "on": "BM_TARIFFEL.RESOURCE_TYPE_ID = BM_RESOURCE_TYPE.RESOURCE_TYPE_ID",
      "note": "Расшифровка типа ресурса для бухгалтерии (MNEMONIC имеет хороший мнемонический смысл)"
    },
    {
      "table": "BM_ZONE",
      "type": "LEFT JOIN",
      "on": "BM_TARIFFEL.ZONE_ID = BM_ZONE.ZONE_ID",
      "note": "Тарифная зона с фиксированной ценой в тарифном плане"
    }
  ],
  "usage_notes": [
    "Используется для расчета доходов от клиентов",
    "MONEY содержит цену/стоимость тарифного элемента",
    "Для расчета себестоимости нужно сравнить доходы (из BM_TARIFFEL.MONEY) с затратами (из STECCOM_EXPENSES.AMOUNT и TARIFF_PLANS)",
    "STEP1-STEP4 могут использоваться для ступенчатой тарификации превышения трафика"
  ]
}

