{
  "description": "DDL statements для загрузки в векторную базу знаний. Содержит CREATE TABLE и CREATE VIEW statements для всех таблиц и представлений схемы billing.",
  "tables": [
    {
      "table_name": "SPNET_TRAFFIC",
      "ddl": "CREATE TABLE SPNET_TRAFFIC (ID SERIAL PRIMARY KEY, TOTAL_ROWS INTEGER, CONTRACT_ID VARCHAR(50), IMEI VARCHAR(50), SIM_ICCID VARCHAR(50), SERVICE VARCHAR(100), USAGE_TYPE VARCHAR(100), USAGE_BYTES NUMERIC, USAGE_UNIT VARCHAR(20), TOTAL_AMOUNT NUMERIC(10,2), BILL_MONTH INTEGER, PLAN_NAME VARCHAR(100), IMSI VARCHAR(50), MSISDN VARCHAR(50), ACTUAL_USAGE NUMERIC, CALL_SESSION_COUNT INTEGER, SP_ACCOUNT_NO INTEGER, SP_NAME VARCHAR(100), SP_REFERENCE VARCHAR(100), SOURCE_FILE VARCHAR(200), LOAD_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP, CREATED_BY VARCHAR(50) DEFAULT CURRENT_USER);",
      "source": "postgresql/tables/01_spnet_traffic.sql"
    },
    {
      "table_name": "STECCOM_EXPENSES",
      "ddl": "CREATE TABLE STECCOM_EXPENSES (ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, INVOICE_DATE DATE, COMPANY_NAME VARCHAR2(200), COMPANY_NUMBER NUMBER, SETTLING_PERIOD NUMBER, FEE_TYPE VARCHAR2(100), CONTRACT_ID VARCHAR2(50), IMSI_ISDNA VARCHAR2(50), ICC_ID_IMEI VARCHAR2(50), ACTIVATION_DATE DATE, TRANSACTION_DATE DATE, SERVICE VARCHAR2(100), RATE_TYPE VARCHAR2(100), PLAN_DISCOUNT VARCHAR2(100), DESCRIPTION VARCHAR2(500), PRORATED_DAYS NUMBER, AMOUNT NUMBER(10,2), GROUP_NAME VARCHAR2(100), SOURCE_FILE VARCHAR2(200), LOAD_DATE DATE DEFAULT SYSDATE, CREATED_BY VARCHAR2(50) DEFAULT USER);",
      "source": "oracle/tables/02_steccom_expenses.sql"
    },
    {
      "table_name": "TARIFF_PLANS",
      "ddl": "CREATE TABLE TARIFF_PLANS (ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, PLAN_NAME VARCHAR2(100) NOT NULL UNIQUE, PLAN_CODE VARCHAR2(20), INCLUDED_KB NUMBER NOT NULL, TIER1_FROM_KB NUMBER, TIER1_TO_KB NUMBER, TIER1_PRICE_USD NUMBER(10,4), TIER2_FROM_KB NUMBER, TIER2_TO_KB NUMBER, TIER2_PRICE_USD NUMBER(10,4), TIER3_FROM_KB NUMBER, TIER3_PRICE_USD NUMBER(10,4), ACTIVE VARCHAR2(1) DEFAULT 'Y' CHECK (ACTIVE IN ('Y', 'N')), CREATED_DATE DATE DEFAULT SYSDATE, CREATED_BY VARCHAR2(50) DEFAULT USER, COMMENTS VARCHAR2(500));",
      "source": "oracle/tables/03_tariff_plans.sql"
    },
    {
      "table_name": "IRIDIUM_SERVICES_INFO",
      "ddl": "CREATE TABLE IRIDIUM_SERVICES_INFO (SERVICE_ID INTEGER, CONTRACT_ID VARCHAR(50), IMEI VARCHAR(50), TARIFF_ID INTEGER, AGREEMENT_NUMBER VARCHAR(200), ORDER_NUMBER VARCHAR(100), STATUS INTEGER, ACTUAL_STATUS INTEGER, CUSTOMER_ID INTEGER, ORGANIZATION_NAME VARCHAR(500), PERSON_NAME VARCHAR(500), CUSTOMER_NAME VARCHAR(500), CREATE_DATE TIMESTAMP, START_DATE TIMESTAMP, STOP_DATE TIMESTAMP, ACCOUNT_ID INTEGER, IS_SUSPENDED VARCHAR(1), CODE_1C VARCHAR(100));",
      "source": "postgresql/tables/05_iridium_services_info.sql",
      "note": "В Oracle это VIEW V_IRIDIUM_SERVICES_INFO, в PostgreSQL - таблица (импорт)"
    }
  ],
  "views": [
    {
      "view_name": "V_SPNET_OVERAGE_ANALYSIS",
      "description": "Базовый анализ превышения трафика. Использует SPNET_TRAFFIC и TARIFF_PLANS. Группирует по IMEI, CONTRACT_ID, BILL_MONTH.",
      "source": "oracle/views/01_v_spnet_overage_analysis.sql",
      "note": "DDL для VIEW слишком большой, см. исходный SQL файл"
    },
    {
      "view_name": "V_CONSOLIDATED_OVERAGE_REPORT",
      "description": "Консолидированный отчет SPNet + STECCOM. Объединяет данные трафика и расходов по периодам.",
      "source": "oracle/views/02_v_consolidated_overage_report.sql",
      "note": "DDL для VIEW слишком большой, см. исходный SQL файл"
    },
    {
      "view_name": "V_IRIDIUM_SERVICES_INFO",
      "description": "Информация о сервисах с данными клиентов. VIEW в Oracle, таблица в PostgreSQL.",
      "source": "oracle/views/03_v_iridium_services_info.sql",
      "note": "DDL для VIEW слишком большой, см. исходный SQL файл"
    },
    {
      "view_name": "V_CONSOLIDATED_REPORT_WITH_BILLING",
      "description": "Расширенный отчет с данными клиентов и fees. Используется для экспорта в 1С.",
      "source": "oracle/views/04_v_consolidated_report_with_billing.sql",
      "note": "DDL для VIEW слишком большой, см. исходный SQL файл"
    }
  ],
  "usage": "Для загрузки DDL в векторную БД используйте исходные SQL файлы из директорий oracle/ и postgresql/. DDL для VIEW слишком объемные для включения в JSON, поэтому используйте исходные SQL файлы напрямую."
}







